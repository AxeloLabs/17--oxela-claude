# Types et énumérations

enum UserRole {
  ADMIN
  CUSTOMER
}

enum OrderStatus {
  PENDING
  PROCESSING
  SHIPPED
  DELIVERED
  CANCELLED
}

enum ProductStatus {
  ACTIVE
  INACTIVE
  OUT_OF_STOCK
}

# Type User (lié à Firebase Auth)
type User @table {
  id: UUID! @default(expr: "uuidV4()")
  firebaseUid: String! @unique
  email: String! @unique
  displayName: String
  photoURL: String
  role: UserRole! @default(value: CUSTOMER)
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
}

# Type Category
type Category @table {
  id: UUID! @default(expr: "uuidV4()")
  name: String!
  slug: String! @unique
  description: String
  imageUrl: String
  parentId: UUID
  createdAt: Timestamp! @default(expr: "request.time")
}

# Type Product
type Product @table {
  id: UUID! @default(expr: "uuidV4()")
  name: String!
  slug: String! @unique
  description: String!
  price: Float!
  compareAtPrice: Float
  stock: Int! @default(value: 0)
  status: ProductStatus! @default(value: ACTIVE)
  imageUrl: String!
  images: [String!]
  categoryId: UUID!
  sku: String @unique
  weight: Float
  dimensions: String
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
}

# Type Order
type Order @table {
  id: UUID! @default(expr: "uuidV4()")
  orderNumber: String! @unique
  userId: UUID!
  status: OrderStatus! @default(value: PENDING)
  subtotal: Float!
  shippingCost: Float!
  tax: Float!
  total: Float!
  
  # Adresse de livraison
  shippingName: String!
  shippingAddress: String!
  shippingCity: String!
  shippingPostalCode: String!
  shippingCountry: String!
  
  # Adresse de facturation
  billingName: String!
  billingAddress: String!
  billingCity: String!
  billingPostalCode: String!
  billingCountry: String!
  
  paymentMethod: String!
  paymentStatus: String!
  
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
}

# Type OrderItem
type OrderItem @table {
  id: UUID! @default(expr: "uuidV4()")
  orderId: UUID!
  productId: UUID!
  quantity: Int!
  priceAtTime: Float!
  subtotal: Float!
}

# Type Review
type Review @table {
  id: UUID! @default(expr: "uuidV4()")
  productId: UUID!
  userId: UUID!
  rating: Int!
  title: String
  comment: String!
  verified: Boolean! @default(value: false)
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
}

# Type CartItem (panier)
type CartItem @table {
  id: UUID! @default(expr: "uuidV4()")
  userId: UUID!
  productId: UUID!
  quantity: Int!
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
}
